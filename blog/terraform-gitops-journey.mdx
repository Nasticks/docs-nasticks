---
title: "Architecture Cloud Native"
sidebarTitle: "Architecture Globale"
description: "Vue d'ensemble de ma plateforme DevOps sur AWS."
icon: "map"
---

## Mon Voyage GitOps avec Terraform sur AWS

Bienvenue dans le r√©cit de ma transformation digitale personnelle ! J'ai r√©cemment migr√© mon site web portfolio vers une architecture **GitOps** enti√®rement automatis√©e sur AWS, en utilisant **Terraform** pour le provisionnement de l'infrastructure.

J'ai donc construit une cha√Æne de d√©ploiement compl√®te, automatis√©e et s√©curis√©e, traitant mon infrastructure exactement comme du logiciel (**Infrastructure as Code**).

## üèóÔ∏è Architecture Technique

Le projet repose sur une architecture **Serverless** h√©berg√©e sur AWS, enti√®rement provisionn√©e par code.

```mermaid
graph TD
    User([Utilisateur]) -->|HTTPS| S3["AWS S3 Bucket<br>(Hosting)"]
    
    subgraph "CI/CD Factory (GitHub Actions)"
        Code[Code Source] -->|Push| CI[Pipeline CI/CD]
        CI -->|Terraform Plan/Apply| AWS[AWS Infrastructure]
        CI -->|Build & Sync| Content[Contenu Statique]
        CI -->|Playwright| Test["Tests E2E & Monitoring"]
    end
    
    subgraph "S√©curit√© & State"
        OIDC["OpenID Connect<br>(Sans cl√©s d'acc√®s)"]
        State["S3 Bucket<br>(Terraform State)"]
        Lock["DynamoDB<br>(State Locking)"]
    end

    CI -.->|Auth OIDC| OIDC
    AWS -.->|Store State| State
    AWS -.->|Lock| Lock

```

## La Stack Technique

J'ai choisi des outils modernes et standards du march√© :
* **Frontend :** [Astro](https://astro.build/) pour la performance (HTML statique ultra-l√©ger).
* **IaC :** [Terraform](https://www.terraform.io/) pour provisionner AWS (S3, IAM, DynamoDB).
* **CI/CD :** GitHub Actions pour l'orchestration.
* **Qualit√© :** Trivy (Scan de vuln√©rabilit√©s) et Playwright (Tests E2E).

## L'Architecture GitOps

Le principe est simple : **Git est la source unique de v√©rit√©**. Je ne touche jamais √† la console AWS manuellement.

1.  Je push mon code sur la branche `main`.
2.  GitHub Actions lance **Terraform**.
3.  Terraform v√©rifie l'√©tat actuel sur AWS (via un State stock√© sur S3 chiffr√©).
4.  Si tout est conforme, il applique les changements.
5.  Ensuite, le site Astro est compil√© et synchronis√© sur le Bucket S3.

## Les D√©fis Techniques Rencontr√©s

Tout n'a pas √©t√© rose. Voici deux probl√®mes int√©ressants que j'ai d√ª r√©soudre :

### 1. Le "State Locking"
Travailler avec Terraform en √©quipe (ou avec une CI) n√©cessite de verrouiller le fichier d'√©tat pour √©viter que deux processus n'√©crivent en m√™me temps.
> **Solution :** J'ai d√©ploy√© une table **AWS DynamoDB** qui sert de verrou (Lock). Si le pipeline plante, je dois parfois utiliser `terraform force-unlock` pour lib√©rer la situation.

### 2. Le cercle vicieux des permissions
Pour que Terraform cr√©e l'infrastructure, il lui faut des droits Admin. Mais pour lui donner des droits, il faut cr√©er un r√¥le IAM... avec Terraform ?
> **Solution :** J'ai utilis√© une approche "Bootstrap". J'ai cr√©√© le strict minimum (Bucket S3 + Table DynamoDB) via le CLI AWS une seule fois, puis j'ai import√© ces ressources dans Terraform pour qu'il prenne le relais.

## Conclusion

Ce projet est plus qu'un site web : c'est une preuve de concept (POC) d'une usine logicielle moderne. Il est r√©silient, s√©curis√© par d√©faut, et enti√®rement automatis√©.

Le code source est disponible sur mon [GitHub](https://github.com/Nasticks/portfolio-devops). N'h√©sitez pas √† aller voir le code Terraform !